"use strict";angular.module("tinkApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngMessages","ngSanitize","ngTouch","tink.navigation","tink.tinkApi","tink.datepicker","tink.identitycardnumber","tink.fieldsetEditable","tink.sticktotop"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("tinkApp").controller("MainCtrl",["$scope",function(a){a.skeleton=!0}]),angular.module("tink.fieldsetEditable",[]).directive("tinkFieldsetEditable",["$timeout",function(a){return{restrict:"AE",scope:{data:"="},link:function(b,c){function d(a,d){$(c).addClass("fieldset-editable-is-active"),b.editModeActive=!0;var e=$(c).find("form");b.originalContents=$(e).serializeArray(),console.log(b.originalContents),b.originalData=angular.copy(b.data),console.log(b.originalData),b.checkboxClicked=d,$(c).removeClass("fieldset-editable-is-hovered")}function e(a){a="undefined"!=typeof a?a:!1;var d=$(c).find(":input").get();$.each(d,function(){""===this.value&&"submit"!==this.type&&$(this).parents(".input-add").length>0&&($(this).parents(".input-add").toggle(0),$(this).parents(".input-add").prev().toggle(0))}),a?(g(),$("input").blur(),console.log("Changes saved!")):(f(b.originalContents,d),console.log("Operation cancelled!")),0===$("input:focus").length&&(b.editModeActive=!1,$(c).removeClass("fieldset-editable-is-active"),$(".btn-submit").prop("disabled",!0))}function f(a,d){if(!$(c).find(".btn-submit").prop("disabled")){for(var e={},f=0,g=a.length;g>f;f++)e[a[f].name]=a[f].value;$.each(d,function(){this.name&&e[this.name]?"checkbox"===this.type?""!==b.checkboxClicked?$(this).prop("checked",!1):$(this).prop("checked",!0):"radio"===this.type?this.value===$("#"+this.name).val()?$(this).prop("checked",!0):$(this).prop("checked",!1):$(this).val(e[this.name]):"checkbox"===this.type?""!==b.checkboxClicked&&$(this).prop("checked",!0):"radio"===this.type?$(this).prop("checked",!1):$(this).prop("disabled")===!1&&$(this).val("")}),b.data=angular.copy(b.originalData),console.log(b.data),b.$apply()}return!0}function g(){var a=$(c).find("input[type='radio']").get();$.each(a,function(){this.checked&&$("#"+this.name).val(this.value)})}function h(){$(c).find(".btn-submit").prop("disabled",!1)}b.data={},jQuery(document).ready(function(){g()}),a(function(){b.editModeActive=!1,b.originalContents=[],b.originalData={},b.checkboxClicked="",$(c).find(":input, .faux-input, input[type='checkbox'] + label, input[type='radio'] + label, .datepicker-icon, .add-icon").hover(function(){b.editModeActive||$(c).addClass("fieldset-editable-is-hovered")},function(){b.editModeActive||$(c).removeClass("fieldset-editable-is-hovered")}),$(c).find(":input, .faux-input").focus(function(a){b.editModeActive||d(a,"")}),$(c).find(".add-icon").click(function(a){b.editModeActive||(a.preventDefault(),d(a,""),$(this).prev().focus())}),$(c).find("input[type='checkbox'], input[type='radio']").change(function(){b.editModeActive||d(event,this),$(c).find(".btn-submit").prop("disabled",!1)}),$(c).click(function(a){$(a.target).is(".btn-submit")&&(a.stopPropagation(),e(!0)),$(a.target).is(".btn-cancel")&&(a.stopPropagation(),e()),$(a.target).is(".btn-cancel")||a.stopPropagation()}),$(c).find("form").submit(function(){e(!0)}),$(c).find(":input").on("input",function(){h()}),b.$watchCollection("data",function(a,c){b.editModeActive&&a!==c&&h()},!0)})}}}]);